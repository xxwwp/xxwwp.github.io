---
title: 复制功能
createAt: 2021-10-25
slug: notes/复制功能
publish: true
tags:
  - 复制
  - copy
  - 拷贝
archives:
  - 笔记
---

## 实现

使用 ts 实现

```ts
function copy(text: string) {
  if (navigator.clipboard?.writeText) {
    // w3 标准
    navigator.clipboard.writeText(text);
  } else if ((window as any).clipboardData?.setData) {
    // 兼容 ie
    (window as any).clipboardData.setData("Text", text);
  } else if (document.queryCommandSupported?.("copy")) {
    // 使用已废弃的 document.execCommand 方法
    const ref = document.createElement("textarea");
    document.appendChild(ref);
    ref.value = text;
    ref.select();
    document.execCommand("copy");
    ref.remove();
  } else {
    return false;
  }
  return true;
}
```

编译版本：

```js
"use strict";
function copy(text) {
  var _a, _b, _c;
  if ((_a = navigator.clipboard) === null || _a === void 0 ? void 0 : _a.writeText) {
    // w3 标准
    navigator.clipboard.writeText(text);
  } else if ((_b = window.clipboardData) === null || _b === void 0 ? void 0 : _b.setData) {
    // 兼容 ie
    window.clipboardData.setData("Text", text);
  } else if ((_c = document.queryCommandSupported) === null || _c === void 0 ? void 0 : _c.call(document, "copy")) {
    // 使用已废弃的 document.execCommand 方法
    const ref = document.createElement("textarea");
    document.appendChild(ref);
    ref.value = text;
    ref.select();
    document.execCommand("copy");
    ref.remove();
  } else {
    return false;
  }
  return true;
}
```

## 参考

- [stack overflow][1]
- [w3][2]

[1]: https://stackoverflow.com/questions/400212/how-do-i-copy-to-the-clipboard-in-javascript
[2]: https://www.w3.org/TR/clipboard-apis/#async-clipboard-api
